# dmv-scheduler

A customer-service oriented scheduling system for a DMV-like office.

Try it out on SWISH [here](https://swish.swi-prolog.org/p/dmv_scheduler.swinb).

## Introduction

This repository offers a scheduling system written in [Prolog](https://en.wikipedia.org/wiki/Prolog) and runnable (in-browser,  no installation required) in an online environment called [SWISH](https://swish.swi-prolog.org/). 

This scheduling system was developed for use in a large, public-facing government office. Prior to its introduction, scheduling was done manually, which took a significant amount of time and did not always result in a fair distribution of assignments. The system has been used successfully since early 2024.

The scheduling system is generic enough that it may be useful in other domains. As the work of an employee of the U.S.
federal government, it is in the public domain in the United States.

## Concepts

	worker(alice_a).
	day(mon).
	day_task_count(mon, manager, 1).

Scheduling is performed by assigning __workers__ to __tasks__ on a given __day__.

The user defines the workers, days, and a count of desired tasks on a given day.

A task may be thought of as an "assigment"; for example, at an airline check-in counter, one worker could be assigned to the "economy" check-in line, while another could be assigned to the "business" check-in line.

I assume a worker can only perform one task on one day. In reality, workers may be able to do multiple tasks; for example, if all business passengers have been checked in, a worker assigned to the "business" check-in line may switch to the "economy" check-in line. This level of detail isn't necessary to capture at the time of scheduling.

	available_on(alice_a, 	[mon, tue, wed, thu, fri]).

Workers have __availability__, which specifies on which days they may be assigned tasks. I assume that availability is defined at the level of an entire day. Specifying more granular availability (e.g., morning vs. afternoon shifts, or hour-by-hour) is out of scope (but possible in principle).

	can_do(alice_a, manager).

Workers also have __compatibility__, which specifies which tasks workers are able to perform. Some tasks can be performed by any worker, but other tasks require specific skills or training, meaning that only specified workers can do these tasks.

	day_task_count(mon, window(_), 6).

Most tasks are fungible, meaning we don't distinguish one task assignment from another (like the "manager" task). However, some tasks are non-fungible. Specifically, this scheduling system implements non-fungible "window" tasks that represent assigning a specific worker to a specific, numbered window on a given day. This "window" represents a limited, rival physical resource that two workers cannot use at the same time. Additionally, workers should be randomly assigned to windows.

Think of a DMV; workers shouldn't get assigned to the same window/counter every day, as that could introduce predictable bias into customer service, e.g., if the "nice" worker is always at counter 7. One way to mitigate this issue is also commonly found at DMVs: the "take a number" mechanism that directs customers to a specific worker. However, in offices that process a high volume of customers and desire to maximize throughput, a single queue ("snake" queue) is typically subtantially more efficient. Thus the scheduling systems ensures workers are not assigned to specific windows in a predictable manner.

## Other Features

	cannot_do(xavier_x, desk).

In additional to compatibility, the scheduling systems also allows users to define __non-compatibility__, effectively overriding the assumption that any worker can perform certain basic tasks on a case-by-case basis. This can be useful for new employees or employees in training.

	initial_schedule(mon, ivan_i, desk).

It's also possible to __override__ scheduling and manually assign any worker to a task on any day. This can be helpful when there's some constraint not captured by the scheduler that still affects how scheduling should be performed. For example, if a worker will be out of the office part of the morning for a dental appointment, it's possible to manually assign them a task that doesn't involve direct customer interaction.

__Resources__ like windows / counters can be enabled/disabled as needed; if the computer at a given workstation is out of order, you can inform the scheduler, and it will not assign any worker to that location.

Likewise, __days__ of the week can be enabled/disabled completely, which helps to easily avoid scheduling on holidays that fall during the work week.

The scheduler has the concept of a __padding__ task, which is a task that will be assigned to all remaining workers who are available and have not already been assigned some other task. This ensures that everyone will be assigned some job, without having to explicitly define the exact number of tasks.

	Scheduling failed for mon-window(21) because there are no unassigned workers who are also available on this day.

Scheduling failures occur when you ask for too many tasks for the available number of compatible workers. The scheduler attempts to explain scheduling failures by identifying which constraint cannot be satisfied, and why.

## Example

Schedules are output as a table whose rows are workers, columns are days, and cells are tasks.

Tasks shows as '-' indicate the worker is unavailable.

<table class="render-table">
<tbody><tr class="hrow"><th><span class="pl-string">Name</span></th><th><span class="pl-string">Monday</span></th><th><span class="pl-string">Tuesday</span></th><th><span class="pl-string">Wednesday</span></th><th><span class="pl-string">Thursday</span></th><th><span class="pl-string">Friday</span></th></tr>
<tr><td><span class="pl-quoted-atom">'Alice A.'</span></td><td><span class="pl-atom">manager</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">17</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">manager</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">16</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">manager</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Bob B.'</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">13</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">15</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">14</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">16</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'Charlie C.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">15</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">-</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">16</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">-</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">14</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'David D.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">16</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">18</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">12</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">17</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">15</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'Frank F.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">14</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">16</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">12</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">17</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'Grace G.'</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">-</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Heidi H.'</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">manager</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">17</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">manager</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">13</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'Ivan I.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">12</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">-</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">13</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">15</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Judy J.'</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">12</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">desk</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Michael M.'</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Olivia O.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">13</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">18</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Peggy P.'</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">17</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">15</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">14</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">12</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td></tr>
<tr><td><span class="pl-quoted-atom">'Rupert R.'</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">14</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">18</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-compound pl-adaptive pl-level-0" data-arity="1" data-name="window"><span class="pl-functor pl-trigger">window<span class="pl-punct">(</span></span><span class="pl-compound-args"><span class="pl-compound-arg"><span class="pl-int">13</span></span><span class="pl-compound-close pl-punct">)</span></span></span></td><td><span class="pl-atom">desk</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Ted T.'</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">secondary</span></td><td><span class="pl-atom">secondary</span></td><td><span class="pl-atom">secondary</span></td><td><span class="pl-atom">-</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Victor V.'</span></td><td><span class="pl-atom">secondary</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td></tr>
<tr><td><span class="pl-quoted-atom">'Wendy W.'</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">-</span></td><td><span class="pl-atom">secondary</span></td></tr>
</tbody></table>

